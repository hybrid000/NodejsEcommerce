<script>

    document.querySelectorAll('#wishlistForm').forEach(form => {

        form.addEventListener('submit', function (event) {
            event.preventDefault();

            const productId = this.getAttribute('data-product-id');

            async function addToWishlist(productId) {
                try {
                    const response = await fetch(`/user/wishlist/${productId}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                    });

                    if (!response.ok) {
                        throw new Error(`Failed to add product to wishlist. Status: ${response.status}`);
                    }

                    const data = await response.json();
                    alert(data.message);
                    window.location.href = `/product/${productId}`;
                } catch (error) {
                    console.error('Error:', error);
                }
            }

            addToWishlist(productId);

        });
    });

</script>

<script>

    document.querySelectorAll('#cartForm').forEach(form => {

        form.addEventListener('submit', function (event) {
            event.preventDefault();

            const productId = this.getAttribute('data-product-id');

            fetch(`/user/cart/${productId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    window.location.href = `/product/${productId}`; // Redirect to the user's cart page
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Handle errors or show an appropriate message to the user
                });
        })
    });
</script>

<script>
    // Get all the star elements
    const stars = document.querySelectorAll('.star');

    // Add a click event listener to each star
    stars.forEach((star) => {
        star.addEventListener('click', () => {
            // Get the rating value from the data-rating attribute
            const rating = parseInt(star.getAttribute('data-rating'));


            // Update the hidden input field value
            document.getElementById('rating').value = rating;

            // Remove the 'active' class from all stars
            stars.forEach((s) => s.classList.remove('activate'));

            // Add the 'active' class to the clicked star and previous stars
            for (let i = 0; i < rating; i++) {
                stars[i].classList.add('activate');
            }
        });
    });
</script>